# main.yml
name: deploy to aliyun
on:
  push:
    branches: [ master ]
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      # åˆ‡æ¢åˆ†æ”¯
      - name: Checkout
        uses: actions/checkout@v2
      # ä½¿ç”¨ node:16.14.0
      - name: use Node.js 16.14.0
        uses: actions/setup-node@v1
        with:
          node-version: 16.14.0
      # npm install
      - name: npm install and build
        run: |
          #cd Vnaive # è¿›å…¥é¡¹ç›®ç›®å½•
          npm install pnpm -g
          pnpm install  # å®‰è£…ä¾èµ–
          pnpm run build  # æ‰§è¡Œæ‰“åŒ…
      # Deploy
  # è¿æ¥åˆ°sshï¼Œå¹¶ä¸”åšä¸€ä¸ªæ‹·è´æ“ä½œçš„action
  # name: rsync-deployments æ˜¯é€šè¿‡sshé€šè¿‡rsyncéƒ¨ç½²ä»£ç çš„GitHubæ“ä½œ
      - name: Deploy ğŸš€
        uses: cross-the-world/scp-pipeline@master
        env:
          WELCOME: "ssh scp ssh pipelines"
          LASTSSH: "Doing something after copying"
        with:
         host: ${{ secrets.ALY_HOST }}
         user: ${{ secrets.ALY_USER }}
         pass: ${{ secrets.ALY_PASS }}
         local: ${{ secrets.EV_LOCAL }} # æ„å»ºå®Œæˆåé™æ€ç›®å½•çš„åœ°å€
         remote: ${{ secrets.ALY_DIR }} # æ”¾åˆ°æœåŠ¡å™¨ä¸ŠæŒ‡å®šæ–‡ä»¶å¤¹
         connect_timeout: 15s
            
